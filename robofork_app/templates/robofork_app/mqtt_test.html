{% extends "base.html" %}
{% block title %}通信テスト | Robofork{% endblock %}

{% block content %}
    <div class="container">
        <h2>通信テスト</h2>
        <div class="alert alert-primary" role="alert">送信データ</div>
        <div class="form-group row">
            <label for="can_id" class="col-sm-2 col-form-label">CAN_ID(Hex)</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="can_id" name="can_id" value=""/>
            </div>
        </div>
        <div class="form-group row">
            <label for="can_data" class="col-sm-2 col-form-label">CAN_DATA(Hex)</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="can_data" name="can_data" value=""/>
            </div>
        </div>
        <div class="form-group row">
            <div class="col-sm-10 offset-2">
                <button type="button" id="can_send" class="btn btn-primary">送信</button>
            </div>
        </div>

        <div class="alert alert-info" role="alert">受信データ</div>

    </div>

    <script type="text/javascript">
    $(function() {
        $('#can_send').click(function() {
            $.ajax({
                url: 'mqtt_test/send',
                type: 'POST',
                data: {
                    can_id: $('#can_id').val(),
                    can_data: $('#can_data').val()
                }
            }).done(function(data) {
                if (data["result"] && data["result"] == true) {
                    $('#can_id').val("");
                    $('#can_data').val("");
                }
            });
        });
    });
    </script>
{% endblock %}